<p>admin-page works!</p>

<ion-content id="content" [fullscreen]="true">
  <ng-container *ngIf="loading; else loaded">
    <div id="loader">
      <h2>{{loadingMessage}}</h2>
      <br>
      <img src="assets/500.gif">
    </div>
  </ng-container>
  <ng-template #loaded>
    <div id="show">
      <div *ngIf="adminLogged">      
        <ion-grid>
          <ion-row class="headings">
            <ion-col id="notApprovedHeadCol">
              <h2 id="notApprovedHead">Not Approved</h2>
            </ion-col>
            <ion-col id="approvedHeadCol">
              <h2 id="approvedHead">File Upload
                <a rel="noopener" id="adminHelpGuide" target="_blank" href="{{sacredTomeLocation}}">
                  <ion-icon color="dark" name="help-circle"></ion-icon>
                </a>
              </h2>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col id="notApprovedBodyCol">
              <ion-card class="listingCard" *ngFor="let listing of nonAppListings" (click)="redirectToPage(listing)">
                <ion-grid>
                  <ion-row>
                    <ion-col size="4" class="imageCol">
                  <img src="{{listing.photos[0]}}"  onerror="this.src='assets/no-propertyfound.png'" class="headerImg" alt="house1">
                  </ion-col>
                  <ion-col size="8" (click)="redirectToPage(listing)">
                    <ion-grid>
                      <ion-row>
                        <ion-col>
                          <ion-card-title style="color: #0DAE4F;">R {{listing.price}}</ion-card-title>
                        </ion-col>
                      </ion-row>
                    </ion-grid>
                    <p><b>{{listing.address}}</b></p>
                    <p style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap">
                      {{listing.bed}} Bedroom {{listing.prop_type === "Commercial"? listing.prop_type + " Property" : listing.prop_type}}
                    </p>
                    <ng-template [ngIf]="listing.let_sell === 'Sell'">
                      <p>For Sale!</p>
                    </ng-template>
                    <ng-template [ngIf]="listing.let_sell === 'Rent'">
                      <p>To Let!</p>
                    </ng-template>
                    <p id="house_description">
                    {{listing.desc}}
                    </p>
                    <div id="house_details">
                      <img src="assets/icon/bedrooms.png">
                      {{listing.bed}}
                      &nbsp; &nbsp;&nbsp;
                      <img src="assets/icon/bathrooms.png">
                      {{listing.bath}}
                      &nbsp; &nbsp;&nbsp;
                      <img src="assets/icon/floorplan.png">
                      {{listing.floor_size}} m<sup>2</sup>
                      &nbsp; &nbsp;&nbsp;
                      <img src="assets/icon/erf.png">
                      {{listing.property_size}} m<sup>2</sup>
                    </div>
                  </ion-col>
                </ion-row>
              </ion-grid>
              </ion-card>
            </ion-col>
            <ion-col style="text-align: center;">
              <ion-grid style="padding: 0 2%;">
                <ion-row class="file-upload">
                  <div id="popoverHeading"><h3>Import Municipal Data</h3></div><br>
                  <ng-container *ngIf="!muniUploaded; else showMuniFiles">
                      <div class="drag-drop-area-muni" (click)="muniFileInput.click()">
                        <ion-icon name="add-circle-outline" class="icon-on-top"></ion-icon>
                        <ion-label class="imageText">Click here or drag and drop a file</ion-label>
                        <input type="file" accept="file/*" (change)="handleFileInput($event, 'muni')" hidden #muniFileInput>
                      </div>
                  </ng-container>
                  <ng-template #showMuniFiles>
                    
                  </ng-template>
                </ion-row>
                  <ion-row class="file-upload">
                    <div id="popoverHeading"><h3>Import Crime Data</h3></div><br>
                    <ng-container *ngIf="!muniUploaded; else sanitationDiv">
                      <div class="text-container">
                        <h5>Please Upload municipality data first</h5>
                      </div>
                    </ng-container>
                    <ng-template #sanitationDiv>
                        <div class="drag-drop-area" (click)="crimeFileInput.click()" >
                          <ion-icon name="add-circle-outline" class="icon-on-top"></ion-icon>
                          <ion-label class="imageText">Click here or drag and drop a file</ion-label>
                          <input type="file" accept="file/*" (change)="handleFileInput($event, 'crime')" hidden #crimeFileInput>
                        </div>
                        <ion-input type="text" [(ngModel)]="quarter" placeholder="Enter a quater of the form MONTH YEAR to MONTH YEAR" clearInput></ion-input>
                      </ng-template>
                    </ion-row>
                    <ion-row class="file-upload">
                      <div id="popoverHeading"><h3>Import Sanitation Data</h3></div><br>
                      <ng-container *ngIf="!muniUploaded; else saniDiv">
                        <div class="text-container">
                          <h5>Please Upload municipality data first</h5>
                        </div>
                      </ng-container>
                      <ng-template #saniDiv>
                        <div class="drag-drop-area" (click)="sanitationFileInput.click()">
                          <ion-icon name="add-circle-outline" class="icon-on-top"></ion-icon>
                          <ion-label class="imageText">Click here or drag and drop a file</ion-label>
                          <input type="file" accept="file/*" (change)="handleFileInput($event, 'sanitation')" hidden #sanitationFileInput>
                        </div>
                      <div id="popoverHeading"><h3>Import Waste Water Quality Data</h3></div><br>
                      <div class="drag-drop-area" (click)="WWQFileInput.click()">
                        <ion-icon name="add-circle-outline" class="icon-on-top"></ion-icon>
                        <ion-label class="imageText">Click here or drag and drop a file</ion-label>
                        <input type="file" accept="file/*" (change)="handleFileInput($event, 'WWQ')" hidden #WWQFileInput>
                      </div>
                    </ng-template>
                  </ion-row>
                  <ion-row class="file-upload">
                    <div id="popoverHeading"><h3>Import Water Access Data</h3></div><br>
                    <ng-container *ngIf="!muniUploaded; else waterDiv">
                      <div class="text-container">
                        <h5>Please Upload municipality data first</h5>
                      </div>
                    </ng-container>
                    <ng-template #waterDiv>
                      <div class="drag-drop-area" (click)="waterAccessFileInput.click()">
                        <ion-icon name="add-circle-outline" class="icon-on-top"></ion-icon>
                        <ion-label class="imageText">Click here or drag and drop a file</ion-label>
                        <input type="file" accept="file/*" (change)="handleFileInput($event, 'waterAccess')" hidden #waterAccessFileInput>
                      </div>
                      <div id="popoverHeading"><h3>Import Water Quality Data</h3></div><br>
                      <div class="drag-drop-area" (click)="waterQualityFileInput.click()">
                        <ion-icon name="add-circle-outline" class="icon-on-top"></ion-icon>
                        <ion-label class="imageText">Click here or drag and drop a file</ion-label>
                        <input type="file" accept="file/*" (change)="handleFileInput($event, 'waterQuality')" hidden #waterQualityFileInput>
                      </div>
                      <div id="popoverHeading"><h3>Import Water Reliability Data</h3></div><br>
                      <div class="drag-drop-area" (click)="waterReliabilityFileInput.click()">
                        <ion-icon name="add-circle-outline" class="icon-on-top"></ion-icon>
                        <ion-label class="imageText">Click here or drag and drop a file</ion-label>
                        <input type="file" accept="file/*" (change)="handleFileInput($event, 'waterReliability')" hidden #waterReliabilityFileInput>
                      </div>
                      <div id="popoverHeading"><h3>Import Water Tariffs Data</h3></div><br>
                      <div class="drag-drop-area" (click)="waterTariffsFileInput.click()">
                        <ion-icon name="add-circle-outline" class="icon-on-top"></ion-icon>
                        <ion-label class="imageText">Click here or drag and drop a file</ion-label>
                        <input type="file" accept="file/*" (change)="handleFileInput($event, 'waterTariffs')" hidden #waterTariffsFileInput>
                      </div>
                    </ng-template>
                  </ion-row>
                  <ion-row class="file-upload">
                    <div id="popoverHeading"><h3>Selected Files</h3></div><br>
                    <ion-list *ngFor="let file of selectedFiles">
                      <ion-item class="file-name">
                        <ion-icon size="large" name="document-outline"></ion-icon>
                        <ion-label>{{file}}</ion-label>
                      </ion-item>
                    </ion-list>
                  </ion-row>
                  <ion-button style="margin-top: 3%; color: white;" (click)="processData()">Process Data</ion-button>
              </ion-grid>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </div>
  </ng-template>
</ion-content>
